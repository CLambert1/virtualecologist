<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Simulate individual movements â€¢ virtualecologist</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Simulate individual movements">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">virtualecologist</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/simulate-virtual-environment.html">Simulate virtual environment</a></li>
    <li><a class="dropdown-item" href="../articles/simulate-virtual-species.html">Simulate virtual species</a></li>
    <li><a class="dropdown-item" href="../articles/simulate-individual-movements.html">Simulate individual movements</a></li>
    <li><a class="dropdown-item" href="../articles/simulate-survey.html">Simulate survey</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/CLambert1/simtools"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Simulate individual movements</h1>
            
      

      <div class="d-none name"><code>simulate-individual-movements.Rmd</code></div>
    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">virtualecologist</span><span class="op">)</span></span></code></pre></div>
<!-- WARNING - This vignette is generated by {fusen} from dev/flat_simulate_mvmt.Rmd: do not edit by hand -->
<div class="section level2">
<h2 id="define-potential-next-positions">Define potential next positions<a class="anchor" aria-label="anchor" href="#define-potential-next-positions"></a>
</h2>
<p><code><a href="../reference/potential_position_func.html">potential_position_func()</a></code> generates a bunch of potential
positions to choose the next step from. Positions are generated based on
provided bearing (Von Mises) and step (Gamma) distributions. For each
position, the value of resource_layer is retrieved as well as the
distance from the colony location.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">from</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>Lon <span class="op">=</span> <span class="fl">1</span>, Lat <span class="op">=</span> <span class="fl">2</span>, toto <span class="op">=</span> <span class="fl">5</span><span class="op">)</span></span>
<span><span class="va">colony_location</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>Lon <span class="op">=</span> <span class="fl">2</span>, Lat <span class="op">=</span> <span class="fl">5</span><span class="op">)</span></span>
<span><span class="va">cdt</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/generate_env_layer.html">generate_env_layer</a></span><span class="op">(</span>grid <span class="op">=</span> <span class="fu"><a href="../reference/create_grid.html">create_grid</a></span><span class="op">(</span><span class="op">)</span>, n <span class="op">=</span> <span class="fl">1</span><span class="op">)</span><span class="op">$</span><span class="va">rasters</span></span>
<span><span class="co">#&gt; [using unconditional Gaussian simulation]</span></span>
<span><span class="fu"><a href="../reference/potential_position_func.html">potential_position_func</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">10</span>, from <span class="op">=</span> <span class="va">from</span>, </span>
<span>                        colony_location <span class="op">=</span> <span class="va">colony_location</span>, resource_layer <span class="op">=</span> <span class="va">cdt</span>, </span>
<span>                        bearing <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">90</span>,<span class="fl">10</span><span class="op">)</span>, step <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">4.5</span>, <span class="fl">3</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt;        angle      step        Lon       Lat       env dist_col</span></span>
<span><span class="co">#&gt; 1  124.54851 1.3176841  1.5797831 0.8167237 0.5954073 4.204329</span></span>
<span><span class="co">#&gt; 2   38.59724 1.5516632  1.9668066 3.2136489 0.5617037 1.786659</span></span>
<span><span class="co">#&gt; 3  317.19460 1.2513320 -0.2442748 2.1327102 0.6177145 3.641170</span></span>
<span><span class="co">#&gt; 4  185.32546 0.7604406  0.2398684 2.0216779 0.6177145 3.459547</span></span>
<span><span class="co">#&gt; 5   57.06428 0.5626446  1.4894966 2.2774203 0.5421721 2.770028</span></span>
<span><span class="co">#&gt; 6  208.31050 0.9354868  1.5323879 2.7692196 0.5329122 2.279264</span></span>
<span><span class="co">#&gt; 7  190.77661 3.2482543 -1.1179400 4.4628207        NA 3.163876</span></span>
<span><span class="co">#&gt; 8  180.25368 1.2824369  0.5149331 0.8128377 0.6540463 4.442719</span></span>
<span><span class="co">#&gt; 9   22.63236 0.2880789  0.7691424 1.8276799 0.5297902 3.402738</span></span>
<span><span class="co">#&gt; 10 111.86924 0.8619650  1.2896450 1.1881568 0.5954073 3.877467</span></span>
<span><span class="co">#&gt;    potential_position_id</span></span>
<span><span class="co">#&gt; 1                      1</span></span>
<span><span class="co">#&gt; 2                      2</span></span>
<span><span class="co">#&gt; 3                      3</span></span>
<span><span class="co">#&gt; 4                      4</span></span>
<span><span class="co">#&gt; 5                      5</span></span>
<span><span class="co">#&gt; 6                      6</span></span>
<span><span class="co">#&gt; 7                      7</span></span>
<span><span class="co">#&gt; 8                      8</span></span>
<span><span class="co">#&gt; 9                      9</span></span>
<span><span class="co">#&gt; 10                    10</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="simulate-the-trajectory-of-a-single-central-place-forager">Simulate the trajectory of a single central-place forager<a class="anchor" aria-label="anchor" href="#simulate-the-trajectory-of-a-single-central-place-forager"></a>
</h2>
<p><code><a href="../reference/simulate_trajectory_CPF.html">simulate_trajectory_CPF()</a></code> simulates a full foraging
trajectory of an individual departing from its colony. The individual
launches its trip at a given time period (starting_hour, ymd_hms format)
and starts its returning trip either when at a given distance from its
colony (provided with max_dist) or after a given time period
(max_duration). The user can define the bearing and step distributions
for the departing step, but also for the travelling and foraging bouts.
By default, travelling are set to be directed movement patterns (large
steps with low variability, low angles with low variability) and
foraging to be area-restricted movements (short steps with low
variability, large angles with large variability). The user can define
the step duration, that is the time interval at which the positions are
sampled.</p>
<p>For each position, ten potential subsequent positions are randomly
sampled using <code><a href="../reference/potential_position_func.html">potential_position_func()</a></code>, that is with
movement parameters based on the activity the individual is engaged in
at the previous step (travelling or foraging). The environmental
suitability (a raster layer provided with resource_layer) is retrieved
for each potential point based on their geographic coordinates, and
their distance from the colony is computed using the rdist function from
the fields package.</p>
<p>The first four positions of the track after colony departure are
randomly selected within the ten potential points sampled as described
above, using travelling movement. Afterwards, residence time is checked
for every points: residence time is considered reached when a
user-defined number of previous positions (as defined with
residence_time) fall within the residence_radius. If the residence time
is reached, the potential subsequent positions falling outside the
residence_radius are extracted, and the next position is sampled as the
one of them with the highest environmental suitability. If no potential
position falls outside the radius (which can be the case when the radius
largely exceeds the steps), the next position is the point situated at
the largest distance from the previous position in the track. If the
residence time is not reached, the subsequent position is randomly
sampled among the four out of ten potential points which have the
highest values of environmental suitability. If the environmental
suitability exceeds a given threshold (activity_threshold), the
individual switches to foraging movements; if not, the individual
continues travelling.</p>
<p>When individuals reach the threshold distance to colony (max_dist),
or the trip duration exceeds the given duration (max_duration), they
start their homeward journey. Potential next positions are sampled using
only travelling movement parameters, and the next positions are selected
based on the minimum distance to the colony. If several potential
positions meet the selection criteria, the next step is randomly sampled
within these positions. An individual is considered back when within 0.5
spatial unit (the unit depends on the provided resource layer) from the
colony.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://sjmgarnier.github.io/viridis/" class="external-link">viridis</a></span><span class="op">)</span></span>
<span><span class="co">#&gt; Loading required package: viridisLite</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dieghernan.github.io/tidyterra/" class="external-link">tidyterra</a></span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Attaching package: 'tidyterra'</span></span>
<span><span class="co">#&gt; The following object is masked from 'package:stats':</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     filter</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://lubridate.tidyverse.org" class="external-link">lubridate</a></span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Attaching package: 'lubridate'</span></span>
<span><span class="co">#&gt; The following objects are masked from 'package:base':</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     date, intersect, setdiff, union</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://rspatial.org/" class="external-link">terra</a></span><span class="op">)</span></span>
<span><span class="co">#&gt; terra 1.7.78</span></span>
<span><span class="va">colony_location</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>Lon <span class="op">=</span> <span class="fl">20</span>, Lat <span class="op">=</span> <span class="fl">20</span><span class="op">)</span></span>
<span><span class="va">cdt</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/generate_env_layer.html">generate_env_layer</a></span><span class="op">(</span>grid <span class="op">=</span> <span class="fu"><a href="../reference/create_grid.html">create_grid</a></span><span class="op">(</span><span class="op">)</span>, n <span class="op">=</span> <span class="fl">1</span>, seed <span class="op">=</span> <span class="fl">25</span><span class="op">)</span></span>
<span><span class="co">#&gt; [using unconditional Gaussian simulation]</span></span>
<span> </span>
<span><span class="co"># launch a travel for a duration of 12h</span></span>
<span><span class="va">single_traj</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/simulate_trajectory_CPF.html">simulate_trajectory_CPF</a></span><span class="op">(</span>initial_position <span class="op">=</span> <span class="va">colony_location</span>, </span>
<span>                    resource_layer <span class="op">=</span> <span class="va">cdt</span><span class="op">$</span><span class="va">rasters</span>, </span>
<span>                    starting_hour <span class="op">=</span> <span class="fu"><a href="https://lubridate.tidyverse.org/reference/ymd_hms.html" class="external-link">ymd_hms</a></span><span class="op">(</span><span class="st">"2022-08-02 06:00:00"</span><span class="op">)</span>, </span>
<span>                    starting_bearing <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">90</span>,<span class="fl">10</span><span class="op">)</span>, </span>
<span>                    starting_step <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">4.5</span>, <span class="fl">3</span><span class="op">)</span>,</span>
<span>                    travel_bearing <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">20</span><span class="op">)</span>, </span>
<span>                    travel_step <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">3</span>, <span class="fl">3</span><span class="op">)</span>, </span>
<span>                    foraging_bearing <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0.5</span><span class="op">)</span>, </span>
<span>                    foraging_step <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">3</span><span class="op">)</span>,</span>
<span>                    minx <span class="op">=</span> <span class="fl">0</span>, maxx <span class="op">=</span> <span class="fl">90</span>, </span>
<span>                    miny <span class="op">=</span> <span class="fl">0</span>, maxy <span class="op">=</span> <span class="fl">90</span>,</span>
<span>                    max_dist <span class="op">=</span> <span class="fl">40</span>,</span>
<span>                    step_duration <span class="op">=</span> <span class="fl">5</span>,</span>
<span>                    activity_threshold <span class="op">=</span> <span class="fl">0.70</span>,</span>
<span>                    max_duration <span class="op">=</span> <span class="fl">720</span>,</span>
<span>                    residence_radius <span class="op">=</span> <span class="fl">2</span>,</span>
<span>                    residence_time <span class="op">=</span> <span class="fl">20</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># view the trajectory</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">single_traj</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://dieghernan.github.io/tidyterra/reference/geom_spatraster.html" class="external-link">geom_spatraster</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">cdt</span><span class="op">$</span><span class="va">rasters</span>, alpha <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">Lon</span>, y <span class="op">=</span> <span class="va">Lat</span>, color <span class="op">=</span> <span class="va">activity</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">colony_location</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">Lon</span>, y <span class="op">=</span> <span class="va">Lat</span><span class="op">)</span>, col <span class="op">=</span> <span class="st">"red"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://sjmgarnier.github.io/viridis/reference/scale_viridis.html" class="external-link">scale_fill_viridis</a></span><span class="op">(</span>option <span class="op">=</span> <span class="st">"H"</span><span class="op">)</span> </span></code></pre></div>
<p><img src="simulate-individual-movements_files/figure-html/example-simulate_trajectory_CPF-1.png" width="700"></p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="co"># look at the density distribution of distance to colony and movement parameters</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">single_traj</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_density.html" class="external-link">geom_density</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">dist_col</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="simulate-individual-movements_files/figure-html/example-simulate_trajectory_CPF-2.png" width="700"></p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">single_traj</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rspatial.github.io/terra/reference/subset.html" class="external-link">subset</a></span><span class="op">(</span><span class="va">activity</span> <span class="op"><a href="https://rspatial.github.io/terra/reference/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"forage"</span>, <span class="st">"travel"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_density.html" class="external-link">geom_density</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">angle</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="st">"activity"</span><span class="op">)</span></span></code></pre></div>
<p><img src="simulate-individual-movements_files/figure-html/example-simulate_trajectory_CPF-3.png" width="700"></p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">single_traj</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rspatial.github.io/terra/reference/subset.html" class="external-link">subset</a></span><span class="op">(</span><span class="va">activity</span> <span class="op"><a href="https://rspatial.github.io/terra/reference/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"forage"</span>, <span class="st">"travel"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_density.html" class="external-link">geom_density</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">step</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="st">"activity"</span><span class="op">)</span></span></code></pre></div>
<p><img src="simulate-individual-movements_files/figure-html/example-simulate_trajectory_CPF-4.png" width="700"></p>
</div>
<div class="section level2">
<h2 id="simulate-the-trajectory-of-a-non-central-place-forager">Simulate the trajectory of a non-central place forager<a class="anchor" aria-label="anchor" href="#simulate-the-trajectory-of-a-non-central-place-forager"></a>
</h2>
<p><code><a href="../reference/simulate_trajectory_FR.html">simulate_trajectory_FR()</a></code> does the same as above, but the
individual is not restrained around its colony and does not perform
homing bout. In addition, the individual starts selecting its next
positions based on environmental conditions (checking for residence
time) at the third step (against 5th step for central-place
foragers).</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://sjmgarnier.github.io/viridis/" class="external-link">viridis</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dieghernan.github.io/tidyterra/" class="external-link">tidyterra</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://lubridate.tidyverse.org" class="external-link">lubridate</a></span><span class="op">)</span></span>
<span><span class="va">colony_location</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>Lon <span class="op">=</span> <span class="fl">50</span>, Lat <span class="op">=</span> <span class="fl">50</span><span class="op">)</span></span>
<span><span class="va">cdt</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/generate_env_layer.html">generate_env_layer</a></span><span class="op">(</span>grid <span class="op">=</span> <span class="fu"><a href="../reference/create_grid.html">create_grid</a></span><span class="op">(</span><span class="op">)</span>, n <span class="op">=</span> <span class="fl">1</span>, seed <span class="op">=</span> <span class="fl">4</span><span class="op">)</span></span>
<span><span class="co">#&gt; [using unconditional Gaussian simulation]</span></span>
<span>    </span>
<span><span class="va">single_traj</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/simulate_trajectory_FR.html">simulate_trajectory_FR</a></span><span class="op">(</span>initial_position <span class="op">=</span> <span class="va">colony_location</span>, </span>
<span>                    resource_layer <span class="op">=</span> <span class="va">cdt</span><span class="op">$</span><span class="va">rasters</span>, </span>
<span>                    starting_hour <span class="op">=</span> <span class="fu"><a href="https://lubridate.tidyverse.org/reference/ymd_hms.html" class="external-link">ymd_hms</a></span><span class="op">(</span><span class="st">"2022-08-02 06:00:00"</span><span class="op">)</span>,</span>
<span>                    starting_bearing <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">90</span>,<span class="fl">10</span><span class="op">)</span>, </span>
<span>                    starting_step <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">4.5</span>, <span class="fl">3</span><span class="op">)</span>,</span>
<span>                    travel_bearing <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">20</span><span class="op">)</span>, </span>
<span>                    travel_step <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">3</span>, <span class="fl">3</span><span class="op">)</span>, </span>
<span>                    foraging_bearing <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0.5</span><span class="op">)</span>, </span>
<span>                    foraging_step <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">3</span><span class="op">)</span>,</span>
<span>                    minx <span class="op">=</span> <span class="fl">0</span>, maxx <span class="op">=</span> <span class="fl">90</span>, </span>
<span>                    miny <span class="op">=</span> <span class="fl">0</span>, maxy <span class="op">=</span> <span class="fl">90</span>,</span>
<span>                    step_duration <span class="op">=</span> <span class="fl">1</span>,</span>
<span>                    activity_threshold <span class="op">=</span> <span class="fl">0.7</span>,</span>
<span>                    max_duration <span class="op">=</span> <span class="fl">2000</span>,</span>
<span>                    residence_radius <span class="op">=</span> <span class="fl">1</span>,</span>
<span>                    residence_time <span class="op">=</span> <span class="fl">20</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># view the trajectory</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">single_traj</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://dieghernan.github.io/tidyterra/reference/geom_spatraster.html" class="external-link">geom_spatraster</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">cdt</span><span class="op">$</span><span class="va">rasters</span>, alpha <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">Lon</span>, y <span class="op">=</span> <span class="va">Lat</span>, color <span class="op">=</span> <span class="va">activity</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">colony_location</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">Lon</span>, y <span class="op">=</span> <span class="va">Lat</span><span class="op">)</span>, col <span class="op">=</span> <span class="st">"red"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://sjmgarnier.github.io/viridis/reference/scale_viridis.html" class="external-link">scale_fill_viridis</a></span><span class="op">(</span>option <span class="op">=</span> <span class="st">"H"</span><span class="op">)</span> </span></code></pre></div>
<p><img src="simulate-individual-movements_files/figure-html/example-simulate_trajectory_FR-1.png" width="700"></p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="co"># look at the density distribution of distance to colony and movement parameters</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">single_traj</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_density.html" class="external-link">geom_density</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">dist_col</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="simulate-individual-movements_files/figure-html/example-simulate_trajectory_FR-2.png" width="700"></p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">single_traj</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rspatial.github.io/terra/reference/subset.html" class="external-link">subset</a></span><span class="op">(</span><span class="va">activity</span> <span class="op"><a href="https://rspatial.github.io/terra/reference/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"forage"</span>, <span class="st">"travel"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_density.html" class="external-link">geom_density</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">angle</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="st">"activity"</span><span class="op">)</span></span></code></pre></div>
<p><img src="simulate-individual-movements_files/figure-html/example-simulate_trajectory_FR-3.png" width="700"></p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">single_traj</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rspatial.github.io/terra/reference/subset.html" class="external-link">subset</a></span><span class="op">(</span><span class="va">activity</span> <span class="op"><a href="https://rspatial.github.io/terra/reference/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"forage"</span>, <span class="st">"travel"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_density.html" class="external-link">geom_density</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">step</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="st">"activity"</span><span class="op">)</span></span></code></pre></div>
<p><img src="simulate-individual-movements_files/figure-html/example-simulate_trajectory_FR-4.png" width="700"></p>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Charlotte Lambert.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.0.</p>
</div>

    </footer>
</div>





  </body>
</html>
