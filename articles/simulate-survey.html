<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="simtools">
<title>Simulate survey • simtools</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Simulate survey">
<meta property="og:description" content="simtools">
<meta property="og:image" content="/logo.png">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-dark navbar-expand-lg bg-primary"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">simtools</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.0</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/simulate-virtual-environment.html">Simulate virtual environment</a>
    <a class="dropdown-item" href="../articles/simulate-virtual-species.html">Simulate virtual species</a>
    <a class="dropdown-item" href="../articles/simulate-individual-movements.html">Simulate individual movements</a>
    <a class="dropdown-item" href="../articles/simulate-survey.html">Simulate survey</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/CLambert1/simtools">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Simulate survey</h1>
            
      
      
      <div class="d-none name"><code>simulate-survey.Rmd</code></div>
    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">simtools</span><span class="op">)</span></span></code></pre></div>
<!-- WARNING - This vignette is generated by {fusen} from dev/flat_simulate_survey.Rmd: do not edit by hand -->
<div class="section level2">
<h2 id="generate-a-transect-design">1. Generate a transect design<a class="anchor" aria-label="anchor" href="#generate-a-transect-design"></a>
</h2>
<p>This design can be done with the <a href="https://github.com/DistanceDevelopment/dssd" class="external-link">dssd package</a> when
working on real-world examples.</p>
<p>The <code><a href="../reference/generate_survey_plan.html">generate_survey_plan()</a></code> function presented here
provide facilities to build a simple layout. The built layout will
consist of parallel transects covering a given area in the virtual
environment, spaced out by a given distance and segmented by a given
length. The layout can either be horizontal (the default) or vertical.
The design can be generated in virtual or real space, but in the latter
case, be cautious about the units (you should work with projected
coordinates).</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">surv</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/generate_survey_plan.html">generate_survey_plan</a></span><span class="op">(</span>bbx_xmin <span class="op">=</span> <span class="fl">30</span>, bbx_xmax <span class="op">=</span> <span class="fl">65</span>, bbx_ymin <span class="op">=</span> <span class="fl">30</span>, bbx_ymax <span class="op">=</span> <span class="fl">65</span>,</span>
<span>                             start_x <span class="op">=</span> <span class="fl">34</span>, end_x <span class="op">=</span> <span class="fl">60</span>, start_y <span class="op">=</span> <span class="fl">34</span>, end_y <span class="op">=</span> <span class="fl">68</span>,</span>
<span>                             space_out_factor <span class="op">=</span> <span class="fl">2</span>, segmentize <span class="op">=</span> <span class="cn">TRUE</span>, seg_length <span class="op">=</span> <span class="fl">1</span>,</span>
<span>                             buffer <span class="op">=</span> <span class="cn">TRUE</span>, buffer_width <span class="op">=</span> <span class="fl">0.2</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mfrow <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">2</span><span class="op">)</span>, mar <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2.5</span>,<span class="fl">2.5</span>,<span class="fl">4</span>,<span class="fl">0.5</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu">raster</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/base/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">surv</span><span class="op">$</span><span class="va">bbx</span>, axes <span class="op">=</span> <span class="cn">TRUE</span>, main <span class="op">=</span> <span class="st">"bounding box"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/terra/man/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="fu">sf</span><span class="fu">::</span><span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_geometry.html" class="external-link">st_geometry</a></span><span class="op">(</span><span class="va">surv</span><span class="op">$</span><span class="va">transects</span><span class="op">)</span>, axes <span class="op">=</span> <span class="cn">TRUE</span>, main <span class="op">=</span> <span class="st">"transects"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/terra/man/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="fu">sf</span><span class="fu">::</span><span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_geometry.html" class="external-link">st_geometry</a></span><span class="op">(</span><span class="va">surv</span><span class="op">$</span><span class="va">segments</span><span class="op">)</span>, axes <span class="op">=</span> <span class="cn">TRUE</span>, main <span class="op">=</span> <span class="st">"segments"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/terra/man/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="fu">sf</span><span class="fu">::</span><span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_geometry.html" class="external-link">st_geometry</a></span><span class="op">(</span><span class="va">surv</span><span class="op">$</span><span class="va">buffered_segments</span><span class="op">)</span>, axes <span class="op">=</span> <span class="cn">TRUE</span>, main <span class="op">=</span> <span class="st">"buffered seg"</span><span class="op">)</span></span></code></pre></div>
<p><img src="simulate-survey_files/figure-html/examples-generate_survey_plan-1.png" width="700"></p>
</div>
<div class="section level2">
<h2 id="assign-a-flight-plan-to-the-survey">2. Assign a flight plan to the survey<a class="anchor" aria-label="anchor" href="#assign-a-flight-plan-to-the-survey"></a>
</h2>
<p>Before launching a survey, a flight plan must be set up, that is the
order by which segments will be surveyed must be chosen. This is done
with <code><a href="../reference/assign_flight_plan.html">assign_flight_plan()</a></code>, which gets a segment objects
(buffered segments from above), a vector providing the order by which
segment table rows will be surveyed, the survey starting date and time,
the speed of the aircraft (from which is calculated the survey duration
of a single segment) and the duration of the transit period between two
successive transects. The function automatically adds a one-second gap
between two consecutive segments to avoid overlapping periods.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">surv</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/generate_survey_plan.html">generate_survey_plan</a></span><span class="op">(</span>bbx_xmin <span class="op">=</span> <span class="fl">30</span>, bbx_xmax <span class="op">=</span> <span class="fl">65</span>, bbx_ymin <span class="op">=</span> <span class="fl">30</span>, bbx_ymax <span class="op">=</span> <span class="fl">65</span>,</span>
<span>                             start_x <span class="op">=</span> <span class="fl">34</span>, end_x <span class="op">=</span> <span class="fl">60</span>, start_y <span class="op">=</span> <span class="fl">34</span>, end_y <span class="op">=</span> <span class="fl">68</span>,</span>
<span>                             space_out_factor <span class="op">=</span> <span class="fl">2</span>, segmentize <span class="op">=</span> <span class="cn">TRUE</span>, seg_length <span class="op">=</span> <span class="fl">1</span>,</span>
<span>                             buffer <span class="op">=</span> <span class="cn">TRUE</span>, buffer_width <span class="op">=</span> <span class="fl">0.2</span></span>
<span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="co"># assign the time periods to each segment</span></span>
<span><span class="va">flight_plan</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/assign_flight_plan.html">assign_flight_plan</a></span><span class="op">(</span></span>
<span>  sf_segments <span class="op">=</span> <span class="va">surv</span><span class="op">$</span><span class="va">buffered_segments</span>,</span>
<span>  flight_id <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">468</span><span class="op">)</span>,</span>
<span>  col_trans_id <span class="op">=</span> <span class="st">"transect"</span>,</span>
<span>  flight_day <span class="op">=</span> <span class="st">"2022-08-01"</span>,</span>
<span>  survey_start_hour <span class="op">=</span> <span class="st">"06:00:00"</span>,</span>
<span>  flight_speed <span class="op">=</span> <span class="fl">160</span>,</span>
<span>  intertransect_gap_duration <span class="op">=</span> <span class="fl">60</span><span class="op">*</span><span class="fl">30</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># plot to check everything is ok</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">flight_plan</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsf.html" class="external-link">geom_sf</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="va">start_time</span><span class="op">)</span>,</span>
<span>            color <span class="op">=</span> <span class="st">"black"</span>, size <span class="op">=</span> <span class="fl">0.2</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_gradient.html" class="external-link">scale_fill_datetime</a></span><span class="op">(</span>low <span class="op">=</span> <span class="st">"#8073ac"</span>, high <span class="op">=</span> <span class="st">"#fdb863"</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>panel.grid <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_blank</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="st">"Hour"</span>, limits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"06:00"</span>, <span class="st">"16:16"</span><span class="op">)</span>, x <span class="op">=</span> <span class="st">"x"</span>, y <span class="op">=</span> <span class="st">"y"</span><span class="op">)</span><span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsf.html" class="external-link">coord_sf</a></span><span class="op">(</span>xlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">90</span><span class="op">)</span>, ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">90</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="simulate-survey_files/figure-html/examples-assign_flight_plan-1.png" width="700"></p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">flight_plan</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsf.html" class="external-link">geom_sf</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="va">flight_id</span><span class="op">)</span>,</span>
<span>            color <span class="op">=</span> <span class="st">"black"</span>, size <span class="op">=</span> <span class="fl">0.2</span><span class="op">)</span></span></code></pre></div>
<p><img src="simulate-survey_files/figure-html/examples-assign_flight_plan-2.png" width="700"></p>
</div>
<div class="section level2">
<h2 id="simulate-survey-on-fixed-individual">3. Simulate survey on fixed individual<a class="anchor" aria-label="anchor" href="#simulate-survey-on-fixed-individual"></a>
</h2>
<p>The <code><a href="../reference/detection_process.html">detection_process()</a></code> function can be used to simulate
the detection process when the surveyed individuals are fixed on the
geographical space, for example when the species distribution is
generated by <code>simul_spat().</code> If strip_transect is emulated,
an individual is considered detected if its distance to the track line
is lower than the width (provided with sigma). If line-transect is
emulated, a half-normal detection function is built using the given
sigma as effective strip half-width. The user must define if the
simulation is done in a virtual space or not (if not, the distances must
be provided in km and pts and transects objects must be projected).</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">grid</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/create_grid.html">create_grid</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">env</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/generate_env_layer.html">generate_env_layer</a></span><span class="op">(</span>grid <span class="op">=</span> <span class="va">grid</span><span class="op">)</span></span>
<span><span class="co">#&gt; [using unconditional Gaussian simulation]</span></span>
<span><span class="va">sp</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/warning.html" class="external-link">suppressWarnings</a></span><span class="op">(</span><span class="fu"><a href="../reference/simul_spat.html">simul_spat</a></span><span class="op">(</span>ref_map <span class="op">=</span> <span class="va">env</span><span class="op">$</span><span class="va">rasters</span><span class="op">$</span><span class="va">sim1</span>,</span>
<span>                 N <span class="op">=</span> <span class="fl">1000</span>, </span>
<span>                 n_sim <span class="op">=</span> <span class="fl">1</span>, </span>
<span>                 return_wgs_coordinates <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">pts</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/detection_process.html">detection_process</a></span><span class="op">(</span>pts <span class="op">=</span> <span class="va">sp</span>, </span>
<span>                         transects <span class="op">=</span> <span class="va">example_data</span><span class="op">$</span><span class="va">survey</span><span class="op">$</span><span class="va">segments</span>, </span>
<span>                         strip_transect <span class="op">=</span> <span class="cn">TRUE</span>, </span>
<span>                         sigma <span class="op">=</span> <span class="fl">0.2</span>, </span>
<span>                         virtual_space <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>                         seg_id_col <span class="op">=</span> <span class="st">"seg_id"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Strip-transect is used with a width of 0.2</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/terra/man/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">sp</span><span class="op">$</span><span class="va">x</span>, <span class="va">sp</span><span class="op">$</span><span class="va">y</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/terra/man/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="fu">sf</span><span class="fu">::</span><span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_geometry.html" class="external-link">st_geometry</a></span><span class="op">(</span><span class="va">example_data</span><span class="op">$</span><span class="va">survey</span><span class="op">$</span><span class="va">segments</span><span class="op">)</span>, col <span class="op">=</span> <span class="st">"red"</span>, add <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/terra/man/lines.html" class="external-link">points</a></span><span class="op">(</span><span class="fu">sf</span><span class="fu">::</span><span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_geometry.html" class="external-link">st_drop_geometry</a></span><span class="op">(</span><span class="va">pts</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/which.html" class="external-link">which</a></span><span class="op">(</span><span class="va">pts</span><span class="op">$</span><span class="va">detected</span> <span class="op">==</span> <span class="fl">1</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"x"</span>, <span class="st">"y"</span><span class="op">)</span><span class="op">]</span><span class="op">)</span>, </span>
<span>       pch <span class="op">=</span> <span class="fl">20</span>, col <span class="op">=</span> <span class="st">"blue"</span><span class="op">)</span></span></code></pre></div>
<p><img src="simulate-survey_files/figure-html/examples-detection_process-1.png" width="700"></p>
</div>
<div class="section level2">
<h2 id="simulate-survey-on-moving-individuals">4. Simulate survey on moving individuals<a class="anchor" aria-label="anchor" href="#simulate-survey-on-moving-individuals"></a>
</h2>
<p>Once we have the movements of a population on one hand, and a survey
design with time periods assigned on the other hand, we can match the
two to simulate the conduction of an observation survey. This is what is
done by the <code><a href="../reference/launch_survey_on_movement.html">launch_survey_on_movement()</a></code> function,
scrutinizing whether movement bouts temporally matching segments are
included within them. If yes, and the centroid of the movement bout is
included in the segment, the individual is considered as sighted by the
survey. This default strip-transect protocol can be changed to
line-transect protocol, in which case a distance-dependent detection
probability is additionally computed for each individual as to defined
whether or not they are detected during the survey.</p>
<p>For the survey to be relevant, the size of the buffer around the
segments must be carefully chosen in <code><a href="../reference/generate_survey_plan.html">generate_survey_plan()</a></code>
as to mimic the maximum distance to the track line considered possible
during a survey (e.g. 200 m for a strip-transect survey; 1 km for a
line-transect survey).</p>
<p>Note: there must not be a too large difference between the size of
segments and that of movement bouts. Because the function simplifies the
movement bouts to their centroids, movement bouts should be on the same
time scale as the segments (seconds). Otherwise, the position
approximated to define if the individual is sighted or not (i.e., the
center of the movement bout) may not be representative of the movement
of the individual.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># an example with a small number of individuals</span></span>
<span><span class="va">survey</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/launch_survey_on_movement.html">launch_survey_on_movement</a></span><span class="op">(</span></span>
<span>  survey_data_buffered <span class="op">=</span> <span class="va">example_data</span><span class="op">$</span><span class="va">flight_plan</span>,</span>
<span>  survey_data_linear <span class="op">=</span> <span class="va">example_data</span><span class="op">$</span><span class="va">survey</span><span class="op">$</span><span class="va">segments</span>,</span>
<span>  traj_data <span class="op">=</span> <span class="va">example_data</span><span class="op">$</span><span class="va">mvmt_data</span>,</span>
<span>  line_transect <span class="op">=</span> <span class="cn">TRUE</span>, detection_function <span class="op">=</span> <span class="st">"hn"</span>,</span>
<span>  sigma <span class="op">=</span> <span class="fl">0.2</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; Applying detection function</span></span>
<span></span>
<span><span class="co"># look at the number of sightings</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/terra/man/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">survey</span><span class="op">$</span><span class="va">effort_table</span><span class="op">$</span><span class="va">N_ind_tot</span><span class="op">)</span></span>
<span><span class="co">#&gt;    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. </span></span>
<span><span class="co">#&gt; 0.00000 0.00000 0.00000 0.03846 0.00000 6.00000</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/terra/man/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="fu">sf</span><span class="fu">::</span><span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_geometry.html" class="external-link">st_drop_geometry</a></span><span class="op">(</span><span class="va">survey</span><span class="op">$</span><span class="va">obs_table</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"dist_seg"</span>, <span class="st">"prob_dist"</span><span class="op">)</span><span class="op">]</span><span class="op">)</span>, </span>
<span>     xlab <span class="op">=</span> <span class="st">"distance to the track line"</span>, ylab <span class="op">=</span> <span class="st">"detection probability"</span><span class="op">)</span></span></code></pre></div>
<p><img src="simulate-survey_files/figure-html/examples-launch_survey_on_movement-1.png" width="700"></p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="co"># all sightings are in a few segments</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">survey</span><span class="op">$</span><span class="va">effort_table</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsf.html" class="external-link">geom_sf</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">survey</span><span class="op">$</span><span class="va">obs_table</span>, </span>
<span>          <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>shape <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/terra/man/is.bool.html" class="external-link">as.factor</a></span><span class="op">(</span><span class="va">detected</span><span class="op">)</span><span class="op">)</span>, size <span class="op">=</span> <span class="fl">2</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsf.html" class="external-link">geom_sf</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="va">N_ind_tot</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu">viridis</span><span class="fu">::</span><span class="fu"><a href="https://sjmgarnier.github.io/viridis/reference/scale_viridis.html" class="external-link">scale_fill_viridis</a></span><span class="op">(</span>limits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">10</span><span class="op">)</span>, </span>
<span>                              na.value <span class="op">=</span> <span class="cn">NA</span>, alpha <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span></span></code></pre></div>
<p><img src="simulate-survey_files/figure-html/examples-launch_survey_on_movement-2.png" width="700"></p>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Charlotte Lambert.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
