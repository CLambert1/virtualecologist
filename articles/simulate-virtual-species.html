<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Simulate virtual species • virtualecologist</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Simulate virtual species">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">virtualecologist</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/simulate-virtual-environment.html">Simulate virtual environment</a></li>
    <li><a class="dropdown-item" href="../articles/simulate-virtual-species.html">Simulate virtual species</a></li>
    <li><a class="dropdown-item" href="../articles/simulate-individual-movements.html">Simulate individual movements</a></li>
    <li><a class="dropdown-item" href="../articles/simulate-survey.html">Simulate survey</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/CLambert1/simtools"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Simulate virtual species</h1>
            
      

      <div class="d-none name"><code>simulate-virtual-species.Rmd</code></div>
    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">virtualecologist</span><span class="op">)</span></span></code></pre></div>
<!-- WARNING - This vignette is generated by {fusen} from dev/flat_simulate_sp.Rmd: do not edit by hand -->
<div class="section level2">
<h2 id="create-a-custom-projection">Create a custom projection<a class="anchor" aria-label="anchor" href="#create-a-custom-projection"></a>
</h2>
<p>The upcoming analyses necessitates working in a projected
environment. Because we are in a virtual environment, we must define a
custom projection. This is what does <code><a href="../reference/custom_proj.html">custom_proj()</a></code>.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/custom_proj.html">custom_proj</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; Coordinate Reference System:</span></span>
<span><span class="co">#&gt;   User input: PROJCS["Ad_hoc_handy_wkt2_template_for_laea",</span></span>
<span><span class="co">#&gt; GEOGCS["WGS 84",</span></span>
<span><span class="co">#&gt;     DATUM["WGS_1984",</span></span>
<span><span class="co">#&gt;         SPHEROID["WGS 84",6378137,298.257223563]],</span></span>
<span><span class="co">#&gt;     PRIMEM["Greenwich",0],</span></span>
<span><span class="co">#&gt;     UNIT["Degree",0.0174532925199433]],</span></span>
<span><span class="co">#&gt; PROJECTION["Lambert_Azimuthal_Equal_Area"],</span></span>
<span><span class="co">#&gt; PARAMETER["latitude_of_center",0],</span></span>
<span><span class="co">#&gt; PARAMETER["longitude_of_center",0],</span></span>
<span><span class="co">#&gt; PARAMETER["false_easting",0],</span></span>
<span><span class="co">#&gt; PARAMETER["false_northing",0],</span></span>
<span><span class="co">#&gt; UNIT["metre",1]] </span></span>
<span><span class="co">#&gt;   wkt:</span></span>
<span><span class="co">#&gt; PROJCRS["Ad_hoc_handy_wkt2_template_for_laea",</span></span>
<span><span class="co">#&gt;     BASEGEOGCRS["WGS 84",</span></span>
<span><span class="co">#&gt;         DATUM["World Geodetic System 1984",</span></span>
<span><span class="co">#&gt;             ELLIPSOID["WGS 84",6378137,298.257223563,</span></span>
<span><span class="co">#&gt;                 LENGTHUNIT["metre",1,</span></span>
<span><span class="co">#&gt;                     ID["EPSG",9001]]]],</span></span>
<span><span class="co">#&gt;         PRIMEM["Greenwich",0,</span></span>
<span><span class="co">#&gt;             ANGLEUNIT["Degree",0.0174532925199433]]],</span></span>
<span><span class="co">#&gt;     CONVERSION["unnamed",</span></span>
<span><span class="co">#&gt;         METHOD["Lambert Azimuthal Equal Area",</span></span>
<span><span class="co">#&gt;             ID["EPSG",9820]],</span></span>
<span><span class="co">#&gt;         PARAMETER["Latitude of natural origin",0,</span></span>
<span><span class="co">#&gt;             ANGLEUNIT["Degree",0.0174532925199433],</span></span>
<span><span class="co">#&gt;             ID["EPSG",8801]],</span></span>
<span><span class="co">#&gt;         PARAMETER["Longitude of natural origin",0,</span></span>
<span><span class="co">#&gt;             ANGLEUNIT["Degree",0.0174532925199433],</span></span>
<span><span class="co">#&gt;             ID["EPSG",8802]],</span></span>
<span><span class="co">#&gt;         PARAMETER["False easting",0,</span></span>
<span><span class="co">#&gt;             LENGTHUNIT["metre",1],</span></span>
<span><span class="co">#&gt;             ID["EPSG",8806]],</span></span>
<span><span class="co">#&gt;         PARAMETER["False northing",0,</span></span>
<span><span class="co">#&gt;             LENGTHUNIT["metre",1],</span></span>
<span><span class="co">#&gt;             ID["EPSG",8807]]],</span></span>
<span><span class="co">#&gt;     CS[Cartesian,2],</span></span>
<span><span class="co">#&gt;         AXIS["(E)",east,</span></span>
<span><span class="co">#&gt;             ORDER[1],</span></span>
<span><span class="co">#&gt;             LENGTHUNIT["metre",1]],</span></span>
<span><span class="co">#&gt;         AXIS["(N)",north,</span></span>
<span><span class="co">#&gt;             ORDER[2],</span></span>
<span><span class="co">#&gt;             LENGTHUNIT["metre",1]]]</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="simulate-spatial-point-process">Simulate spatial point process<a class="anchor" aria-label="anchor" href="#simulate-spatial-point-process"></a>
</h2>
<p><code><a href="../reference/simul_spat.html">simul_spat()</a></code> generates a spatial point process from a
reference map, using Inhomogeneous Poisson Point Process with spatstat’s
IPP. The intensity of the process is proportional to this reference map,
and the final number of simulated points is provided by N. Several runs
can be simulated at the same time. A mark can be associated with each
point to define the group size of each sighting (with the
mean_group_size parameter).</p>
<p>To do : add an id to each generated obs (only done when n_sim =
1)</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">grid</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/create_grid.html">create_grid</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">cdt</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/generate_env_layer.html">generate_env_layer</a></span><span class="op">(</span>grid <span class="op">=</span> <span class="va">grid</span><span class="op">)</span></span>
<span><span class="co">#&gt; [using unconditional Gaussian simulation]</span></span>
<span><span class="va">rsce</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/generate_resource_layer.html">generate_resource_layer</a></span><span class="op">(</span>env_layers <span class="op">=</span> <span class="va">cdt</span><span class="op">$</span><span class="va">rasters</span>,</span>
<span>                            beta <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>, <span class="op">-</span><span class="fl">1.5</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># issue a warning: we are in a virtual env and ref_map has no crs</span></span>
<span><span class="va">out</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/simul_spat.html">simul_spat</a></span><span class="op">(</span>ref_map <span class="op">=</span> <span class="va">rsce</span><span class="op">$</span><span class="va">rasters</span>, n_sim <span class="op">=</span> <span class="fl">2</span>, </span>
<span>                  return_wgs_coordinates <span class="op">=</span> <span class="cn">FALSE</span>, N <span class="op">=</span> <span class="fl">1000</span>, mean_group_size <span class="op">=</span> <span class="fl">10</span><span class="op">)</span></span>
<span><span class="co">#&gt; Warning in simul_spat(ref_map = rsce$rasters, n_sim = 2, return_wgs_coordinates</span></span>
<span><span class="co">#&gt; = FALSE, : ref_map has no crs, is that voluntary? The output will have no crs.</span></span>
<span></span>
<span><span class="co"># plot the simulated distribution</span></span>
<span><span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">out</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_tile.html" class="external-link">geom_tile</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">rsce</span><span class="op">$</span><span class="va">dataframe</span>, <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">x</span>, y <span class="op">=</span> <span class="va">y</span>, fill <span class="op">=</span> <span class="va">suitability</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsf.html" class="external-link">geom_sf</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="st">"name"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">viridis</span><span class="fu">::</span><span class="fu"><a href="https://sjmgarnier.github.io/viridis/reference/scale_viridis.html" class="external-link">scale_fill_viridis</a></span><span class="op">(</span>option <span class="op">=</span> <span class="st">"H"</span><span class="op">)</span></span></code></pre></div>
<p><img src="simulate-virtual-species_files/figure-html/examples-simul_spat-1.png" width="700"></p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="co"># check the generated group size</span></span>
<span><span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">out</span><span class="op">)</span> <span class="op">+</span></span>
<span>   <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsf.html" class="external-link">geom_sf</a></span><span class="op">(</span><span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>size <span class="op">=</span> <span class="va">size</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="st">"name"</span><span class="op">)</span> </span></code></pre></div>
<p><img src="simulate-virtual-species_files/figure-html/examples-simul_spat-2.png" width="700"></p>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Charlotte Lambert.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.0.</p>
</div>

    </footer>
</div>





  </body>
</html>
